{"version":3,"sources":["scripts/mn-select.class.js"],"names":["MnSelect","self","_this","_ret","_classCallCheck","this","tabIndex","setMenu","setMobile","setSelected","setOptionEvents","setOpenEvents","setCloseEvents","setNameGetter","_possibleConstructorReturn","tabindex","getAttribute","setAttribute","menu","document","createElement","style","transform","classList","add","Array","from","children","forEach","child","option","textContent","attributes","attr","name","value","parentNode","removeChild","appendChild","insertBefore","firstChild","options","querySelector","cloneNode","cancelButton","removeAttribute","mobile","append","body","viewValue","selectedOption","_this2","querySelectorAll","concat","addEventListener","event","target","close","focus","nextFocusable","key","nextElementSibling","previousElementSibling","stopPropagation","preventDefault","_this3","open","focusOption","_this4","contains","esc","keyCode","isOpened","clickOutside","closest","selectOption","form","element","Object","defineProperty","get","select","remove","type","elementFromPoint","clientX","clientY","lastSelected","console","error","undefined","HTMLElement","window","customElements","define"],"mappings":"sxCAAMA,SAAAA,SAAAA,cACJ,QAAAA,UAAYC,MAAM,GAAAC,OAAAC,IAUhB,OAVgBC,iBAAAC,KAAAL,UAChBC,KAAAA,MAAAA,2BAAAA,MAAAA,SAAAA,WAAAA,OAAAA,eAAAA,WAAAA,KAAAA,KAAaA,OACbC,MAAKI,WACLJ,MAAKK,UACLL,MAAKM,YACLN,MAAKO,cACLP,MAAKQ,kBACLR,MAAKS,gBACLT,MAAKU,iBACLV,MAAKW,gBACLV,KAAOF,KAAPa,2BAAAZ,MAAAC,sGAIA,GAAMY,UAAWV,KAAKW,aAAa,aAAe,GAClDX,MAAKY,aAAa,WAAYF,4CAI9B,GAAMG,MAAOC,SAASC,cAAc,OACpCF,MAAKG,MAAMC,UAAY,yBAEvBJ,KAAKK,UAAUC,IAAI,WAEnBC,MACGC,KAAKrB,KAAKsB,UACVC,QAAQ,SAAAC,OAEP,GAAMC,QAASX,SAASC,cAAc,MACtCU,QAAOP,UAAUC,IAAI,oBACrBM,OAAOC,YAAcF,MAAME,YAC3BD,OAAOb,aAAa,WAAY,MAEhCQ,MACGC,KAAKG,MAAMG,YACXJ,QAAQ,SAAAK,MAAA,MAAQH,QAAOb,aAAagB,KAAKC,KAAMD,KAAKE,SAEvDN,MAAMO,WAAWC,YAAYR,OAC7BX,KAAKoB,YAAYR,UAGrBzB,KAAKkC,aAAarB,KAAMb,KAAKmC,gDAI7B,GAAMC,SAAUtB,SAASC,cAAc,OACjCF,KAAOb,KAAKqC,cAAc,QAAQC,WAAU,GAC5CC,aAAezB,SAASC,cAAc,SAE5CqB,SAAQlB,UAAUC,IAAI,oBACtBN,KAAK2B,gBAAgB,SACrB3B,KAAK2B,gBAAgB,SACrBD,aAAab,YAAc,SAE3B1B,KAAKyC,OAASL,QACdA,QAAQM,OAAO7B,MACfuB,QAAQM,OAAOH,cAEfzB,SAAS6B,KAAKD,OAAON,+CAIrB,GAAMQ,WAAY9B,SAASC,cAAc,OACnC8B,eAAiB7C,KAAKW,aAAa,eACrCX,KAAKqC,cAAc,+BACnBrC,KAAKqC,cAAc,gCAChBrC,KAAKqC,cAAc,oBAE1B,IAAIQ,eAAgB,CAClB,GAAMf,OAAQe,eAAelC,aAAa,UAAYkC,eAAenB,WACrE1B,MAAK8B,MAAQA,MACb9B,KAAKkB,UAAUC,IAAI,aACnByB,UAAUlB,YAAcmB,eAAenB,YAEzC1B,KAAKkC,aAAaU,UAAW5C,KAAKmC,sDAGlB,GAAAW,QAAA9C,KACVoC,QAAUpC,KAAK+C,iBAAiB,qBAChCN,OAASrB,MAAMC,KAAKrB,KAAKyC,OAAOM,iBAAiB,qBAEvD3B,OACGC,KAAKe,SACLY,OAAOP,QACPlB,QAAQ,SAAAE,QAAA,MAAUA,QAAOwB,iBAAiB,QAAS,SAAAC,OAClD,GAAMpB,OAAQoB,MAAMC,OAAOxC,aAAa,UAAYuC,MAAMC,OAAOzB,WACjEoB,QAAKhB,MAAQA,MACbgB,OAAKM,YAGThB,QACGb,QAAQ,SAAAE,QAAA,MAAUA,QAAOwB,iBAAiB,YAAa,SAAAC,OACtDA,MAAMC,OAAOE,YAGjBjB,QACGb,QAAQ,SAAAE,QAAA,MAAUA,QAAOwB,iBAAiB,UAAW,SAAAC,OACpD,GAAII,eAAAA,MACJ,QAAQJ,MAAMK,KACZ,IAAK,YACHD,cAAgBJ,MAAMC,OAAOK,kBAC7B,MACF,KAAK,UACHF,cAAgBJ,MAAMC,OAAOM,uBAI7BH,gBACFA,cAAcD,QACdH,MAAMQ,kBACNR,MAAMS,sBAIZvB,QACGb,QAAQ,SAAAE,QAAA,MAAUA,QAAOwB,iBAAiB,UAAW,SAAAC,OACpD,GAAkB,UAAdA,MAAMK,IAAiB,CACzB,GAAMzB,OAAQoB,MAAMC,OAAOxC,aAAa,UAAYuC,MAAMC,OAAOzB,WACjEoB,QAAKhB,MAAQA,MACbgB,OAAKM,QACLN,OAAKO,QACLH,MAAMQ,+DAKE,GAAAE,QAAA5D,IACdA,MAAKiD,iBAAiB,QAAS,WAC7BW,OAAKC,OACLD,OAAKE,YAAYZ,SAEnBlD,KAAKiD,iBAAiB,UAAW,SAAAC,OAC/B,OAAQA,MAAMK,KACZ,IAAK,QACL,IAAK,IACHK,OAAKC,OACLD,OAAKE,YAAYZ,OACjBA,MAAMS,6DAKG,GAAAI,QAAA/D,IACfA,MAAKiD,iBAAiB,QAAS,WAAA,MAAMc,QAAKX,UAC1CpD,KAAKyC,OAAOJ,cAAc,UAAUY,iBAAiB,QAAS,WAAA,MAAMc,QAAKX,UACzEpD,KAAKyC,OAAOQ,iBAAiB,QAAS,SAAAC,OAChCA,MAAMC,OAAOjC,UAAU8C,SAAS,qBAClCD,OAAKX,UAGTtC,SAASmC,iBAAiB,QAAS,WACjC,GAAMgB,KAAwB,KAAlBf,MAAMgB,QACdC,SAAWrD,SAAS6B,KAAKzB,UAAU8C,SAAS,oBAE5CC,MAAOE,UACTJ,OAAKX,UAGTtC,SAASmC,iBAAiB,QAAS,SAAAC,OACjC,GAAMkB,eAAgBlB,MAAMC,OAAOkB,QAAQ,aACrCC,aAAepB,MAAMC,OAAOjC,UAAU8C,SAAS,qBAEjDI,cAAgBE,eAClBP,OAAKX,kDAMT,GAAMmB,MAAOvE,KAAKqE,QAAQ,QACpBxC,KAAO7B,KAAKW,aAAa,QACzB6D,QAAUxE,IAEZuE,OAAQ1C,MACV4C,OAAOC,eAAeH,KAAM1C,MAAO8C,IAAK,WAAA,MAAMH,2CA8BhDxE,KAAKoD,QACLpD,KAAKkB,UAAUC,IAAI,WACnBnB,KAAKyC,OAAOvB,UAAUC,IAAI,WAC1BL,SAAS6B,KAAKzB,UAAUC,IAAI,qDAI5B,GAAMyD,QAAS9D,SAASuB,cAAc,oBAElCuC,UACFA,OAAO1D,UAAU2D,OAAO,WACxBD,OAAOnC,OAAOvB,UAAU2D,OAAO,WAC/B/D,SAAS6B,KAAKzB,UAAU2D,OAAO,0DAIvB3B,OACV,GAAmB,UAAfA,MAAM4B,KAAkB,CAE1B,GAAMrD,QAASX,SAASiE,iBAAiB7B,MAAM8B,QAAS9B,MAAM+B,QAC9DxD,QAAO4B,YACF,IAAmB,YAAfH,MAAM4B,KAAoB,CACnC,GAAMrD,SAASzB,KAAKqC,cAAc,gCAC7BrC,KAAKqC,cAAc,gCACxBZ,SAAO4B,qCAlDDvB,OACR,GAAML,QAASzB,KAAKqC,cAAL,4BAA+CP,MAA/C,KAEf,IAAIL,OAAQ,CACVzB,KAAKqC,cAAc,OAAOX,YAAcD,OAAOC,YAC/C1B,KAAKkB,UAAUC,IAAI,YACnB,IAAM+D,cAAezD,OAAOM,WAAWM,cAAc,8BAEjD6C,eACFA,aAAa1C,gBAAgB,YAE/Bf,OAAOb,aAAa,WAAY,gBAEhCuE,SAAQC,MAAR,kEAC+BtD,MAD/B,kFAKF9B,MAAKY,aAAa,QAASkB,uBAI3B,MAAO9B,MAAKW,aAAa,UAAY0E,qBAzMlBC,YA0OvBC,QAAOC,eAAeC,OAAO,YAAa9F","file":"mn-select.js","sourcesContent":["class MnSelect extends HTMLElement {\n  constructor(self) {\n    self = super(self)\n    this.tabIndex()\n    this.setMenu()\n    this.setMobile()\n    this.setSelected()\n    this.setOptionEvents()\n    this.setOpenEvents()\n    this.setCloseEvents()\n    this.setNameGetter()\n    return self\n  }\n\n  tabIndex() {\n    const tabindex = this.getAttribute('tabindex') || '0'\n    this.setAttribute('tabindex', tabindex)\n  }\n\n  setMenu() {\n    const menu = document.createElement('menu')\n    menu.style.transform = 'translate(-17px, -5px)'\n\n    menu.classList.add('mn-card')\n\n    Array\n      .from(this.children)\n      .forEach(child => {\n        // fallback option, some browsers dont support tag option\n        const option = document.createElement('div')\n        option.classList.add('mn-select-option')\n        option.textContent = child.textContent\n        option.setAttribute('tabindex', '-1')\n\n        Array\n          .from(child.attributes)\n          .forEach(attr => option.setAttribute(attr.name, attr.value))\n\n        child.parentNode.removeChild(child)\n        menu.appendChild(option)\n      })\n\n    this.insertBefore(menu, this.firstChild)\n  }\n\n  setMobile() {\n    const options = document.createElement('div')\n    const menu = this.querySelector('menu').cloneNode(true)\n    const cancelButton = document.createElement('button')\n\n    options.classList.add('mn-select-mobile')\n    menu.removeAttribute('class')\n    menu.removeAttribute('style')\n    cancelButton.textContent = 'cancel'\n\n    this.mobile = options\n    options.append(menu)\n    options.append(cancelButton)\n\n    document.body.append(options)\n  }\n\n  setSelected() {\n    const viewValue = document.createElement('div')\n    const selectedOption = this.getAttribute('placeholder')\n      ? this.querySelector('.mn-select-option[selected]')\n      : this.querySelector('.mn-select-option[selected]')\n        || this.querySelector('.mn-select-option')\n\n    if (selectedOption) {\n      const value = selectedOption.getAttribute('value') || selectedOption.textContent\n      this.value = value\n      this.classList.add('has-value')\n      viewValue.textContent = selectedOption.textContent\n    }\n    this.insertBefore(viewValue, this.firstChild)\n  }\n\n  setOptionEvents() {\n    const options = this.querySelectorAll('.mn-select-option')\n    const mobile = Array.from(this.mobile.querySelectorAll('.mn-select-option'))\n\n    Array\n      .from(options)\n      .concat(mobile)\n      .forEach(option => option.addEventListener('click', event => {\n        const value = event.target.getAttribute('value') || event.target.textContent\n        this.value = value\n        this.close()\n      }))\n\n    options\n      .forEach(option => option.addEventListener('mousemove', event => {\n        event.target.focus()\n      }))\n\n    options\n      .forEach(option => option.addEventListener('keydown', event => {\n        let nextFocusable\n        switch (event.key) {\n          case 'ArrowDown':\n            nextFocusable = event.target.nextElementSibling\n            break\n          case 'ArrowUp':\n            nextFocusable = event.target.previousElementSibling\n            break\n        }\n\n        if (nextFocusable) {\n          nextFocusable.focus()\n          event.stopPropagation()\n          event.preventDefault()\n        }\n      }))\n\n    options\n      .forEach(option => option.addEventListener('keydown', event => {\n        if (event.key === 'Enter') {\n          const value = event.target.getAttribute('value') || event.target.textContent\n          this.value = value\n          this.close()\n          this.focus()\n          event.stopPropagation()\n        }\n      }))\n  }\n\n  setOpenEvents() {\n    this.addEventListener('click', () => {\n      this.open()\n      this.focusOption(event)\n    })\n    this.addEventListener('keydown', event => {\n      switch (event.key) {\n        case 'Enter':\n        case ' ':\n          this.open()\n          this.focusOption(event)\n          event.preventDefault()\n      }\n    })\n  }\n\n  setCloseEvents() {\n    this.addEventListener('focus', () => this.close())\n    this.mobile.querySelector('button').addEventListener('click', () => this.close())\n    this.mobile.addEventListener('click', event => {\n      if (event.target.classList.contains('mn-select-mobile')) {\n        this.close()\n      }\n    })\n    document.addEventListener('keyup', () => {\n      const esc = event.keyCode === 27\n      let isOpened = document.body.classList.contains('mn-select-visible')\n\n      if (esc && isOpened) {\n        this.close()\n      }\n    })\n    document.addEventListener('click', event => {\n      const clickOutside = !event.target.closest('mn-select')\n      const selectOption = event.target.classList.contains('mn-select-option')\n\n      if (clickOutside || selectOption) {\n        this.close()\n      }\n    })\n  }\n\n  setNameGetter() {\n    const form = this.closest('form')\n    const name = this.getAttribute('name')\n    const element = this\n\n    if (form && name) {\n      Object.defineProperty(form, name, {get: () => element})\n    }\n  }\n\n  set value(value) {\n    const option = this.querySelector(`.mn-select-option[value=\"${value}\"]`)\n\n    if (option) {\n      this.querySelector('div').textContent = option.textContent\n      this.classList.add('has-value')\n      const lastSelected = option.parentNode.querySelector('.mn-select-option[selected]')\n\n      if (lastSelected) {\n        lastSelected.removeAttribute('selected')\n      }\n      option.setAttribute('selected', 'selected')\n    } else {\n      console.error(`MN-SELECT OPTION_UNDEFINED\n        You're trying set a value (${value}) to mn-select,\n        but there is no option with this value to be displayed`)\n    }\n\n    this.setAttribute('value', value)\n  }\n\n  get value() {\n    return this.getAttribute('value') || undefined\n  }\n\n  open() {\n    this.close()\n    this.classList.add('visible')\n    this.mobile.classList.add('visible')\n    document.body.classList.add('mn-select-visible')\n  }\n\n  close() {\n    const select = document.querySelector('mn-select.visible')\n\n    if (select) {\n      select.classList.remove('visible')\n      select.mobile.classList.remove('visible')\n      document.body.classList.remove('mn-select-visible')\n    }\n  }\n\n  focusOption(event) {\n    if (event.type === 'click') {\n      // focus on option behind mouse\n      const option = document.elementFromPoint(event.clientX, event.clientY)\n      option.focus()\n    } else if (event.type === 'keydown') {\n      const option = this.querySelector('.mn-select-option[selected]')\n        || this.querySelector('.mn-select-option:first-child')\n      option.focus()\n    }\n  }\n}\n\nwindow.customElements.define('mn-select', MnSelect)\n\n"]}