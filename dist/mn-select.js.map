{"version":3,"sources":["scripts/mn-select.class.js"],"names":["MnSelect","self","_this","_ret","_classCallCheck","this","setTabIndex","setMenu","setMobileOptions","setSelected","setOptionEvents","setOpenEvents","setCloseEvents","setNameGetter","_possibleConstructorReturn","form","closest","name","getAttribute","element","Object","defineProperty","get","tabindex","setAttribute","options","querySelectorAll","Array","from","forEach","option","selected","document","createElement","selectedOption","querySelector","value","textContent","classList","add","insertBefore","firstChild","menu","style","transform","children","child","fallbackOption","attributes","attr","parentNode","removeChild","appendChild","cloneNode","cancelButton","remove","removeAttribute","mobileOptions","append","body","_this2","open","addEventListener","event","key","_this3","concat","target","setSelectedOption","close","_this4","contains","esc","keyCode","isOpened","viewValue","setViewValue","console","error","text","lastSelected","type","focusedOption","focus","select","stopPropagation","clickOutside","tagName","setValue","undefined","HTMLElement","window","customElements","define"],"mappings":"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","file":"mn-select.js","sourcesContent":["class MnSelect extends HTMLElement {\n  constructor(self) {\n    self = super(self)\n    this.setTabIndex()\n    this.setMenu()\n    this.setMobileOptions()\n    this.setSelected()\n    this.setOptionEvents()\n    this.setOpenEvents()\n    // this.setArrowEvents()\n    this.setCloseEvents()\n    this.setNameGetter()\n    // this.setRequired()\n    return self\n  }\n\n  // setRequired() {\n  //   const isRequired = this.getAttribute('required')\n  //   const value = this.value\n  //   console.log(this.validity)\n  //   if (isRequired && !value) {\n  //     this.willValidate = true\n  //     console.log(this.willValidate)\n  //     this.setCustomValidity('is required')\n  //   }\n  // }\n\n  setNameGetter() {\n    const form = this.closest('form')\n    const name = this.getAttribute('name')\n    const element = this\n\n    if (form && name) {\n      Object.defineProperty(form, name, {get: () => element})\n    }\n  }\n\n  setTabIndex() {\n    const tabindex = this.getAttribute('tabindex') || '0'\n    this.setAttribute('tabindex', tabindex)\n    const options = this.querySelectorAll('option')\n\n    Array\n      .from(options)\n      .forEach(option => option.setAttribute('tabindex', '0'))\n  }\n\n  setSelected() {\n    const selected = document.createElement('div')\n    const selectedOption = this.getAttribute('placeholder')\n      ? this.querySelector('.mn-select-option[selected]')\n      : this.querySelector('.mn-select-option[selected]') || this.querySelector('.mn-select-option')\n\n    if (selectedOption) {\n      const value = selectedOption.getAttribute('value') || selectedOption.textContent\n      this.value = value\n      this.classList.add('has-value')\n      selected.textContent = selectedOption.textContent\n    }\n    this.insertBefore(selected, this.firstChild)\n  }\n\n  set value(value) {\n    this.setValue(value)\n    this.setAttribute('value', value)\n    const target = this.querySelector(`.mn-select-option[value=\"${value}\"]`)\n\n    if (target) {\n      this.setSelectedOption(target)\n    }\n  }\n\n  get value() {\n    return this.getAttribute('value') || undefined\n  }\n\n  setMenu() {\n    const menu = document.createElement('menu')\n    menu.style.transform = 'translate(-14px, -8px)'\n\n    menu.classList.add('mn-card')\n\n    Array\n      .from(this.children)\n      .forEach(child => {\n        const fallbackOption = document.createElement('div')\n        fallbackOption.classList.add('mn-select-option')\n        fallbackOption.textContent = child.textContent\n\n        Array\n          .from(child.attributes)\n          .forEach(attr => fallbackOption.setAttribute(attr.name, attr.value))\n\n        child.parentNode.removeChild(child)\n        menu.appendChild(fallbackOption)\n      })\n\n    this.insertBefore(menu, this.firstChild)\n  }\n\n  setMobileOptions() {\n    const options = document.createElement('div')\n    const menu = this.querySelector('menu').cloneNode(true)\n    const cancelButton = document.createElement('button')\n\n    options.classList.add('mn-mobile-options')\n    menu.classList.remove('mn-card')\n    menu.removeAttribute('style')\n    cancelButton.textContent = 'cancel'\n\n    this.mobileOptions = options\n    options.append(menu)\n    options.append(cancelButton)\n\n    document.body.append(options)\n  }\n\n  setOpenEvents() {\n    const open = this.open\n    this.addEventListener('click', open)\n    this.addEventListener('keyup', event => {\n      if (event.key === 'Enter' || event.key === ' ') {\n        this.open(event)\n      }\n    })\n  }\n\n  // setArrowEvents() {\n  //   this.addEventListener('keyup', event => {\n  //     const keyIsArrowUpOrDown = event.key === 'ArrowUp' || event.key === 'ArrowDown'\n\n  //     if (keyIsArrowUpOrDown) {\n  //       this.open(event)\n  //     }\n  //   })\n\n  //   const options = this.querySelectorAll('.mn-select-option')\n\n  //   Array\n  //     .from(options)\n  //     .forEach(option => option.addEventListener('keyup', event => {\n  //       if (event.key === 'ArrowDown') {\n  //         event.target.previousElementSibling.focus()\n  //       } else if (event.key === 'ArrowDown') {\n  //         event.target.nextElementSibling.focus()\n  //       }\n  //     }))\n  // }\n\n  setOptionEvents() {\n    const options = this.querySelectorAll('.mn-select-option')\n    const mobileOptions = Array.from(this.mobileOptions.querySelectorAll('.mn-select-option'))\n\n    Array\n      .from(options)\n      .concat(mobileOptions)\n      .forEach(option => option.addEventListener('click', event => {\n        const value = event.target.getAttribute('value') || event.target.textContent\n        this.setSelectedOption(event.target)\n        this.value = value\n        this.close()\n      }))\n  }\n\n  setCloseEvents() {\n    this.mobileOptions.querySelector('button').addEventListener('click', () => this.close())\n    this.mobileOptions.addEventListener('touchend', event => {\n      if (event.target.classList.contains('mn-mobile-options')) {\n        this.close()\n      }\n    })\n    this.mobileOptions.addEventListener('click', event => {\n      if (event.target.classList.contains('mn-mobile-options')) {\n        this.close()\n      }\n    })\n    document.body.addEventListener('click', this.close)\n    document.addEventListener('keyup', () => {\n      const esc = event.keyCode === 27\n      let isOpened = document.body.classList.contains('mn-select-visible')\n\n      if (esc && isOpened) {\n        this.close()\n      }\n    })\n  }\n\n  setValue(value) {\n    const option = this.querySelector(`.mn-select-option[value=\"${value}\"]`)\n    const viewValue = option\n      ? option.textContent\n      : null\n\n    if (viewValue) {\n      this.setViewValue(viewValue)\n      this.classList.add('has-value')\n    } else {\n      console.error(`MN-SELECT OPTION_UNDEFINED\n        You're trying set a value (${value}) to mn-select,\n        but there is no option with this value to be displayed`)\n    }\n  }\n\n  setViewValue(text) {\n    this.querySelector('div').textContent = text\n  }\n\n  setSelectedOption(target) {\n    // const value = target.value || target.textContent\n    // target.parentNode.setAttribute('value', value)\n    const lastSelected = target.parentNode.querySelector('.mn-select-option[selected]')\n\n    if (lastSelected) {\n      lastSelected.removeAttribute('selected')\n    }\n    target.setAttribute('selected', 'selected')\n  }\n\n  open(event) {\n    if (event && event.target.classList.contains('.mn-select-option')) {\n      return false\n    }\n    this.classList.add('visible')\n    this.mobileOptions.classList.add('visible')\n    document.body.classList.add('mn-select-visible')\n\n    if (event && event.type === 'keyup') {\n      const focusedOption = this.querySelector('.mn-select-option[selected]')\n        || this.querySelector('.mn-select-option:first-child')\n      focusedOption.focus()\n    }\n  }\n\n  close(event) {\n    const select = document.querySelector('mn-select.visible')\n    if (event && select) {\n      event.stopPropagation()\n      const clickOutside = event.target.tagName === 'BODY'\n        || event.target.classList.contains('mn-mobile-options')\n        || event.target.classList.contains('mn-select-option')\n\n      if (clickOutside && select) {\n        document.body.classList.remove('mn-select-visible')\n        select.classList.remove('visible')\n        select.mobileOptions.classList.remove('visible')\n      }\n    } else if (select) {\n      document.body.classList.remove('mn-select-visible')\n      select.classList.remove('visible')\n      select.mobileOptions.classList.remove('visible')\n    }\n  }\n}\n\nwindow.customElements.define('mn-select', MnSelect)\n\n"]}