{"version":3,"sources":["scripts/mn-select.class.js"],"names":["MnSelect","self","tabIndex","setMenu","setMobile","setSelected","setOptionEvents","setOpenEvents","setCloseEvents","setFormGetter","setValidation","tabindex","getAttribute","setAttribute","menu","document","createElement","style","transform","classList","add","Array","from","children","forEach","option","textContent","child","attributes","attr","name","value","parentNode","removeChild","appendChild","insertBefore","firstChild","options","querySelector","cloneNode","cancelButton","removeAttribute","mobile","body","viewValue","selectedOption","querySelectorAll","concat","addEventListener","event","target","close","focus","remove","nextFocusable","key","nextElementSibling","previousElementSibling","stopPropagation","preventDefault","open","focusOption","contains","esc","keyCode","isOpened","clickOutside","closest","selectOption","form","element","Object","defineProperty","get","required","input","id","visibility","position","window","MnBackdrop","show","select","hide","type","elementFromPoint","clientX","clientY","lastSelected","console","error","undefined","HTMLElement","customElements","define"],"mappings":"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","file":"mn-select.js","sourcesContent":["class MnSelect extends HTMLElement {\n  constructor(self) {\n    self = super(self)\n    this.tabIndex()\n    this.setMenu()\n    this.setMobile()\n    this.setSelected()\n    this.setOptionEvents()\n    this.setOpenEvents()\n    this.setCloseEvents()\n    this.setFormGetter()\n    this.setValidation()\n    return self\n  }\n\n  tabIndex() {\n    const tabindex = this.getAttribute('tabindex') || '0'\n    this.setAttribute('tabindex', tabindex)\n  }\n\n  setMenu() {\n    const menu = document.createElement('menu')\n    menu.style.transform = 'translate(-17px, -5px)'\n\n    menu.classList.add('mn-card')\n\n    Array\n      .from(this.children)\n      .forEach(child => {\n        // fallback option, some browsers dont support tag option\n        const option = document.createElement('div')\n        option.classList.add('mn-select-option')\n        option.textContent = child.textContent\n        option.setAttribute('tabindex', '-1')\n\n        Array\n          .from(child.attributes)\n          .forEach(attr => option.setAttribute(attr.name, attr.value))\n\n        child.parentNode.removeChild(child)\n        menu.appendChild(option)\n      })\n\n    this.insertBefore(menu, this.firstChild)\n  }\n\n  setMobile() {\n    const options = document.createElement('div')\n    const menu = this.querySelector('menu').cloneNode(true)\n    const cancelButton = document.createElement('button')\n\n    options.classList.add('mn-select-mobile')\n    menu.removeAttribute('class')\n    menu.removeAttribute('style')\n    cancelButton.textContent = 'cancel'\n\n    this.mobile = options\n    options.appendChild(menu)\n    options.appendChild(cancelButton)\n\n    document.body.appendChild(options)\n  }\n\n  setSelected() {\n    const viewValue = document.createElement('div')\n    const selectedOption = this.getAttribute('placeholder')\n      ? this.querySelector('.mn-select-option[selected]')\n      : this.querySelector('.mn-select-option[selected]')\n        || this.querySelector('.mn-select-option')\n\n    if (selectedOption) {\n      const value = selectedOption.getAttribute('value') || selectedOption.textContent\n      this.value = value\n      this.classList.add('has-value')\n      viewValue.textContent = selectedOption.textContent\n    }\n    this.insertBefore(viewValue, this.firstChild)\n  }\n\n  setOptionEvents() {\n    const options = this.querySelectorAll('.mn-select-option')\n    const mobile = Array.from(this.mobile.querySelectorAll('.mn-select-option'))\n\n    Array\n      .from(options)\n      .concat(mobile)\n      .forEach(option => option.addEventListener('click', event => {\n        const value = event.target.getAttribute('value') || event.target.textContent\n        this.value = value\n        this.close()\n      }))\n\n    Array\n      .from(options)\n      .forEach(option => option.addEventListener('mousemove', event => {\n        event.target.focus()\n        event.target.classList.remove('keydown')\n      }))\n\n    Array\n      .from(options)\n      .forEach(option => option.addEventListener('keydown', event => {\n        let nextFocusable\n        switch (event.key) {\n          case 'ArrowDown':\n            nextFocusable = event.target.nextElementSibling\n            break\n          case 'ArrowUp':\n            nextFocusable = event.target.previousElementSibling\n            break\n        }\n\n        if (nextFocusable) {\n          event.target.classList.add('keydown')\n          nextFocusable.focus()\n          event.stopPropagation()\n          event.preventDefault()\n        }\n      }))\n\n    Array\n      .from(options)\n      .forEach(option => option.addEventListener('keydown', event => {\n        if (event.key === 'Enter') {\n          const value = event.target.getAttribute('value') || event.target.textContent\n          this.value = value\n          this.close()\n          this.focus()\n          event.stopPropagation()\n        }\n      }))\n  }\n\n  setOpenEvents() {\n    this.addEventListener('click', event => {\n      this.open()\n      this.focusOption(event)\n    })\n    this.addEventListener('keydown', event => {\n      switch (event.key) {\n        case 'Enter':\n        case ' ':\n          this.open()\n          this.focusOption(event)\n          event.preventDefault()\n      }\n    })\n  }\n\n  setCloseEvents() {\n    this.addEventListener('focus', () => this.close())\n    this.mobile.querySelector('button').addEventListener('click', () => this.close())\n    this.mobile.addEventListener('click', event => {\n      if (event.target.classList.contains('mn-select-mobile')) {\n        this.close()\n      }\n    })\n    document.addEventListener('keyup', event => {\n      const esc = event.keyCode === 27\n      let isOpened = document.body.classList.contains('mn-select-visible')\n\n      if (esc && isOpened) {\n        this.close()\n      }\n    })\n    document.addEventListener('click', event => {\n      const clickOutside = !event.target.closest('mn-select')\n      const selectOption = event.target.classList.contains('mn-select-option')\n\n      if (clickOutside || selectOption) {\n        this.close()\n      }\n    })\n  }\n\n  setFormGetter() {\n    const form = this.closest('form')\n    const name = this.getAttribute('name')\n    const element = this\n\n    if (form && name) {\n      Object.defineProperty(form, name, {get: () => element})\n    }\n  }\n\n  setValidation() {\n    const required = this.getAttribute('required')\n    if (required) {\n      const input = document.createElement('input')\n      input.setAttribute('required', 'required')\n      input.setAttribute('name', this.getAttribute('name') || this.id)\n      input.style.visibility = 'hidden'\n      input.style.position = 'absolute'\n      this.appendChild(input)\n    }\n  }\n\n  set value(value) {\n    const option = this.querySelector(`.mn-select-option[value=\"${value}\"]`)\n    const input = this.querySelector('input')\n\n    if (option) {\n      this.querySelector('div').textContent = option.textContent\n      if (input) {\n        input.value = value\n      }\n      this.classList.add('has-value')\n      const lastSelected = option.parentNode.querySelector('.mn-select-option[selected]')\n\n      if (lastSelected) {\n        lastSelected.removeAttribute('selected')\n      }\n      option.setAttribute('selected', 'selected')\n    } else {\n      console.error(`MN-SELECT OPTION_UNDEFINED\n        You're trying set a value (${value}) to mn-select,\n        but there is no option with this value to be displayed`)\n    }\n\n    this.setAttribute('value', value)\n  }\n\n  get value() {\n    return this.getAttribute('value') || undefined\n  }\n\n  open() {\n    this.close()\n    this.classList.add('visible')\n    this.mobile.classList.add('visible')\n    document.body.classList.add('mn-select-visible')\n    window.MnBackdrop.show()\n  }\n\n  close() {\n    const select = document.querySelector('mn-select.visible')\n\n    if (select) {\n      select.classList.remove('visible')\n      select.mobile.classList.remove('visible')\n      document.body.classList.remove('mn-select-visible')\n      window.MnBackdrop.hide()\n    }\n  }\n\n  focusOption(event) {\n    if (event.type === 'click') {\n      // focus on option behind mouse\n      const option = document.elementFromPoint(event.clientX, event.clientY)\n      option.focus()\n    } else if (event.type === 'keydown') {\n      const option = this.querySelector('.mn-select-option[selected]')\n        || this.querySelector('.mn-select-option:first-child')\n      option.focus()\n    }\n  }\n}\n\nwindow.customElements.define('mn-select', MnSelect)\n\n"]}