{"version":3,"sources":["scripts/mn-select.class.js"],"names":["MnSelect","self","_this","_ret","_classCallCheck","this","setTabIndex","setMenu","setMobileOptions","setSelected","setOptionEvents","setOpenEvents","setCloseEvents","_possibleConstructorReturn","tabindex","getAttribute","setAttribute","options","querySelectorAll","Array","from","forEach","option","selected","document","createElement","selectedOption","querySelector","classList","add","textContent","insertBefore","firstChild","menu","style","transform","children","child","fallbackOption","attributes","attr","name","value","parentNode","removeChild","appendChild","cloneNode","cancelButton","remove","removeAttribute","mobileOptions","append","body","_this2","open","addEventListener","event","key","_this3","keyIsArrowUpOrDown","console","log","target","previousElementSibling","focus","nextElementSibling","_this4","concat","setSelectedOption","setValue","close","_this5","contains","esc","keyCode","isOpened","viewValue","setViewValue","error","text","childNodes","lastSelected","select","stopPropagation","clickOutside","tagName","HTMLElement","window","customElements","define"],"mappings":"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","file":"mn-select.js","sourcesContent":["class MnSelect extends HTMLElement {\n  constructor(self) {\n    self = super(self)\n    this.setTabIndex()\n    this.setMenu()\n    this.setMobileOptions()\n    this.setSelected()\n    this.setOptionEvents()\n    this.setOpenEvents()\n    // this.setArrowEvents()\n    this.setCloseEvents()\n    return self\n  }\n\n  setTabIndex() {\n    const tabindex = this.getAttribute('tabindex') || '0'\n    this.setAttribute('tabindex', tabindex)\n    const options = this.querySelectorAll('option')\n\n    Array\n      .from(options)\n      .forEach(option => option.setAttribute('tabindex', '0'))\n  }\n\n  setSelected() {\n    const selected = document.createElement('div')\n    const selectedOption = this.getAttribute('placeholder')\n      ? this.querySelector('.mn-select-option[selected]')\n      : this.querySelector('.mn-select-option[selected]') || this.querySelector('.mn-select-option')\n\n    if (selectedOption) {\n      this.classList.add('has-value')\n      selected.textContent = selectedOption.textContent\n    }\n    this.insertBefore(selected, this.firstChild)\n  }\n\n  setMenu() {\n    const menu = document.createElement('menu')\n    menu.style.transform = 'translate(-14px, -8px)'\n\n    menu.classList.add('mn-card')\n\n    Array\n      .from(this.children)\n      .forEach(child => {\n        const fallbackOption = document.createElement('div')\n        fallbackOption.classList.add('mn-select-option')\n        fallbackOption.textContent = child.textContent\n\n        Array\n          .from(child.attributes)\n          .forEach(attr => fallbackOption.setAttribute(attr.name, attr.value))\n\n        child.parentNode.removeChild(child)\n        menu.appendChild(fallbackOption)\n      })\n\n    this.insertBefore(menu, this.firstChild)\n  }\n\n  setMobileOptions() {\n    const options = document.createElement('div')\n    const menu = this.querySelector('menu').cloneNode(true)\n    const cancelButton = document.createElement('button')\n\n    options.classList.add('mn-mobile-options')\n    menu.classList.remove('mn-card')\n    menu.removeAttribute('style')\n    cancelButton.textContent = 'cancel'\n\n    this.mobileOptions = options\n    options.append(menu)\n    options.append(cancelButton)\n\n    document.body.append(options)\n  }\n\n  setOpenEvents() {\n    const open = this.open\n    this.addEventListener('click', open)\n    this.addEventListener('keyup', event => {\n      if (event.key === 'Enter' || event.key === ' ') {\n        this.open()\n      }\n    })\n  }\n\n  setArrowEvents() {\n    this.addEventListener('keyup', event => {\n      const keyIsArrowUpOrDown = event.key === 'ArrowUp' || event.key === 'ArrowDown'\n\n      if (keyIsArrowUpOrDown) {\n        this.open()\n      }\n    })\n\n    const options = this.querySelectorAll('.mn-select-option')\n\n    Array\n      .from(options)\n      .forEach(option => option.addEventListener('keyup', event => {\n        if (event.key === 'ArrowDown') {\n          console.log(event.target.previousElementSibling)\n          event.target.previousElementSibling.focus()\n        } else if (event.key === 'ArrowDown') {\n          console.log(event.target.nextElementSibling)\n          event.target.nextElementSibling.focus()\n        }\n      }))\n  }\n\n  setOptionEvents() {\n    const options = this.querySelectorAll('.mn-select-option')\n    const mobileOptions = Array.from(this.mobileOptions.querySelectorAll('.mn-select-option'))\n\n    Array\n      .from(options)\n      .concat(mobileOptions)\n      .forEach(option => option.addEventListener('click', event => {\n        this.setSelectedOption(event.target)\n        this.setValue(event.target.getAttribute('value'))\n        this.close()\n      }))\n  }\n\n  setCloseEvents() {\n    this.mobileOptions.querySelector('button').addEventListener('click', () => this.close())\n    this.mobileOptions.addEventListener('touchend', event => {\n      if (event.target.classList.contains('mn-mobile-options')) {\n        this.close()\n      }\n    })\n    this.mobileOptions.addEventListener('click', event => {\n      if (event.target.classList.contains('mn-mobile-options')) {\n        this.close()\n      }\n    })\n    document.body.addEventListener('click', this.close)\n    document.addEventListener('keyup', () => {\n      const esc = event.keyCode === 27\n      let isOpened = document.body.classList.contains('mn-select-visible')\n\n      if (esc && isOpened) {\n        this.close()\n      }\n    })\n  }\n\n  setValue(value) {\n    const option = this.querySelector(`.mn-select-option[value=\"${value}\"]`)\n    const viewValue = option\n      ? option.textContent\n      : null\n\n    if (viewValue) {\n      this.setViewValue(viewValue)\n      this.classList.add('has-value')\n    } else {\n      console.error(`MN-SELECT OPTION_UNDEFINED\n        You're trying set a value (${value}) to mn-select,\n        but there is no option with this value to be displayed`)\n    }\n  }\n\n  setViewValue(text) {\n    this.childNodes[0].textContent = text\n  }\n\n  setSelectedOption(target) {\n    // const value = target.value || target.textContent\n    // target.parentNode.setAttribute('value', value)\n    const lastSelected = target.parentNode.querySelector('.mn-select-option[selected]')\n\n    if (lastSelected) {\n      lastSelected.removeAttribute('selected')\n    }\n    target.setAttribute('selected', 'selected')\n  }\n\n  open(event) {\n    if (event && event.target.classList.contains('.mn-select-option')) {\n      return false\n    }\n    this.classList.add('visible')\n    this.mobileOptions.classList.add('visible')\n    document.body.classList.add('mn-select-visible')\n    this.querySelector('.mn-select-option[selected], .mn-select-option:first-child').focus()\n  }\n\n  close(event) {\n    const select = document.querySelector('mn-select.visible')\n    if (event && select) {\n      event.stopPropagation()\n      const clickOutside = event.target.tagName === 'BODY'\n        || event.target.classList.contains('mn-mobile-options')\n        || event.target.classList.contains('mn-select-option')\n\n      if (clickOutside && select) {\n        document.body.classList.remove('mn-select-visible')\n        select.classList.remove('visible')\n        select.mobileOptions.classList.remove('visible')\n      }\n    } else if (select) {\n      document.body.classList.remove('mn-select-visible')\n      select.classList.remove('visible')\n      select.mobileOptions.classList.remove('visible')\n    }\n  }\n}\n\nwindow.customElements.define('mn-select', MnSelect)\n\n"]}